(()=>{"use strict";var e={129:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.checkAuth=void 0,o.checkAuth=function(){return!0}},22:function(e,o,t){var i=this&&this.__awaiter||function(e,o,t,i){return new(t||(t=Promise))((function(n,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function l(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?n(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(s,l)}c((i=i.apply(e,o||[])).next())}))};Object.defineProperty(o,"__esModule",{value:!0}),o.productManage=void 0;const n=t(147);o.productManage=class{constructor(e){this.ruta=e}getAll(){return i(this,void 0,void 0,(function*(){try{let e=yield n.promises.readFile(this.ruta,"utf-8");return JSON.parse(e)}catch(e){console.log("error en la lectura"+e)}}))}save(e){return i(this,void 0,void 0,(function*(){try{let o=yield this.getAll(),t=1;o.length>0&&(t=o[o.length-1].id+1);let i=Object.assign(Object.assign({},e),{id:t});o.push(i),n.writeFile(this.ruta,JSON.stringify(o,null,2),(e=>{e?console.log("error en la escritura"+e):console.log("seguardo correctamente")}))}catch(e){console.log("error al guardar"+e)}}))}deleteById(e){return i(this,void 0,void 0,(function*(){try{let o=(yield this.getAll()).filter((o=>o.id!=e));n.writeFile(this.ruta,JSON.stringify(o,null,2),(e=>{e?console.log("error al eliminar"+e):console.log("se elimino correctamente")}))}catch(e){console.log("error al eliminar"+e)}}))}update(e,o){return i(this,void 0,void 0,(function*(){try{if(void 0!==(yield this.getAll()).find((e=>e.id==o))){yield this.deleteById(o);let t=yield this.getAll(),i=Object.assign(Object.assign({},e),{id:o});t.push(i),n.writeFile(this.ruta,JSON.stringify(t,null,2),(e=>{e?console.log("error en la escritura"+e):console.log("seguardo correctamente")}))}}catch(e){console.log("error al actualizar"+e)}}))}getById(e){return i(this,void 0,void 0,(function*(){try{return(yield this.getAll()).find((o=>o.id==e))}catch(e){console.log("error al eliminar"+e)}}))}}},728:function(e,o,t){var i=this&&this.__awaiter||function(e,o,t,i){return new(t||(t=Promise))((function(n,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function l(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?n(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(s,l)}c((i=i.apply(e,o||[])).next())}))};const n=t(860),{productManage:r}=t(22),{checkAuth:s}=t(129),{Router:l}=n,c=n();c.use(n.urlencoded({extended:!0}));const d=new l,a=new l,u=new l;d.use(n.json()),c.use("/api",d),d.use("/productos",a),d.use("/carrito",u),a.get("/:id?",((e,o)=>i(void 0,void 0,void 0,(function*(){let{id:t}=e.params,i=new r("./src/uploads/productos.json");if(void 0===t){let e=yield i.getAll();o.json(e)}else{let e=yield i.getById(t);void 0===e&&o.json("no existe el producto"),o.json(e)}})))),a.post("/",((e,o)=>i(void 0,void 0,void 0,(function*(){if(s()){let t=new r("./src/uploads/productos.json");yield t.save(e.body),o.json("producto guardado")}else o.json("no esta autorizado")})))),a.put("/:id",((e,o)=>i(void 0,void 0,void 0,(function*(){if(s()){let{id:t}=e.params,i=new r("./src/uploads/productos.json");void 0===(yield i.getById(t))?o.json("no existe el producto"):(yield i.update(e.body,t),o.json("actualizado"))}else o.json("no esta autorizado")})))),a.delete("/:id",((e,o)=>i(void 0,void 0,void 0,(function*(){if(s()){let{id:t}=e.params,i=new r("./src/uploads/productos.json");yield i.deleteById(t),o.json(yield i.getAll())}else o.json("no esta autorizado")})))),c.listen(8080,(()=>{console.log("Server running on port 8080")})).on("error",(e=>console.log(e)))},860:e=>{e.exports=require("express")},147:e=>{e.exports=require("fs")}},o={};!function t(i){var n=o[i];if(void 0!==n)return n.exports;var r=o[i]={exports:{}};return e[i].call(r.exports,r,r.exports,t),r.exports}(728)})();