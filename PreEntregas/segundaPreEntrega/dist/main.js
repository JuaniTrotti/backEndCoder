(()=>{"use strict";var e={129:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.checkAuth=void 0,o.checkAuth=function(){return!0}},857:function(e,o,t){var n=this&&this.__awaiter||function(e,o,t,n){return new(t||(t=Promise))((function(i,r){function c(e){try{l(n.next(e))}catch(e){r(e)}}function d(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var o;e.done?i(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(c,d)}l((n=n.apply(e,o||[])).next())}))};Object.defineProperty(o,"__esModule",{value:!0}),o.carritoFirebaseManage=void 0;var i=t(509);const r=t(894);i.initializeApp({credential:i.credential.cert(r)});const c=i.firestore();o.carritoFirebaseManage=class{constructor(e){this.collection=c.collection(e),console.log(`Firebase conectada con la collection ${e}`)}getCarritos(){return n(this,void 0,void 0,(function*(){try{return yield this.collection.get()}catch(e){console.log("error")}}))}carritoById(e){return n(this,void 0,void 0,(function*(){try{return yield this.collection.doc(e).get()}catch(e){console.log("error")}}))}createCarrito(e){return n(this,void 0,void 0,(function*(){try{let o=yield this.maxId(),t={id:o+1,date:new Date,product:[e.product]};yield this.collection.doc(o).set(t),console.log("carrito creado")}catch(e){console.log("error")}}))}deleteCarritoById(e){return n(this,void 0,void 0,(function*(){try{yield this.collection.doc(e).delete(),console.log("carrito eliminado")}catch(e){console.log("error")}}))}maxId(){return n(this,void 0,void 0,(function*(){try{let e=yield this.collection.orderBy("id","desc").limit(1).get();return e.empty?0:e}catch(e){console.log("error")}}))}pushProduct(e,o){return n(this,void 0,void 0,(function*(){try{console.log("push product")}catch(e){console.log("error")}}))}deleteProductById(e,o){return n(this,void 0,void 0,(function*(){try{console.log("delete product")}catch(e){console.log("error")}}))}}},892:function(e,o,t){var n=this&&this.__awaiter||function(e,o,t,n){return new(t||(t=Promise))((function(i,r){function c(e){try{l(n.next(e))}catch(e){r(e)}}function d(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var o;e.done?i(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(c,d)}l((n=n.apply(e,o||[])).next())}))};Object.defineProperty(o,"__esModule",{value:!0}),o.carritoMongoManage=void 0;const i=t(185),{mongoURL:r}=t(792);o.carritoMongoManage=class{constructor(e){this.model=e}getLast(){return n(this,void 0,void 0,(function*(){try{return(yield this.model.findOne().sort({id:-1}).limit(1)).id}catch(e){console.log("error find last")}}))}connect(){return n(this,void 0,void 0,(function*(){try{yield i.connect(r),console.log("conectado a mongo")}catch(e){console.log("error conectando a mongo")}}))}disconnect(){return n(this,void 0,void 0,(function*(){i.connection.close(),console.log("desconectado de mongo")}))}getCarritos(){return n(this,void 0,void 0,(function*(){try{return yield this.model.find()}catch(e){console.log("error find()")}}))}carritoById(e){return n(this,void 0,void 0,(function*(){try{return(yield this.model.findOne({id:e})).product}catch(e){console.log("error find()")}}))}createCarrito(e){return n(this,void 0,void 0,(function*(){try{let e=yield this.getLast();null==e&&(e=0);let o=new this.model({id:e+1,date:new Date,product:[]});yield o.save(),console.log("se creo correctamente")}catch(e){console.log("error create()")}}))}deleteCarritoById(e){return n(this,void 0,void 0,(function*(){try{yield this.model.deleteOne({id:e}),console.log("se elimino correctamente")}catch(e){console.log("error al eliminar")}}))}pushProduct(e,o){return n(this,void 0,void 0,(function*(){try{yield this.model.updateOne({id:e},{$push:{product:o}}),console.log("se agrego correctamente")}catch(e){console.log("error al agregar")}}))}deleteProductById(e,o){return n(this,void 0,void 0,(function*(){try{yield this.model.updateOne({id:e},{$pull:{product:[{id:o}]}}),console.log("se elimino correctamente")}catch(e){console.log("error al eliminar")}}))}}},599:function(e,o,t){var n=this&&this.__awaiter||function(e,o,t,n){return new(t||(t=Promise))((function(i,r){function c(e){try{l(n.next(e))}catch(e){r(e)}}function d(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var o;e.done?i(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(c,d)}l((n=n.apply(e,o||[])).next())}))};Object.defineProperty(o,"__esModule",{value:!0}),o.productMongoManage=void 0;const i=t(185),{mongoURL:r}=t(792);o.productMongoManage=class{constructor(e){this.model=e}getLast(){return n(this,void 0,void 0,(function*(){try{return(yield this.model.findOne().sort({id:-1}).limit(1)).id}catch(e){console.log("error find last")}}))}connect(){return n(this,void 0,void 0,(function*(){try{yield i.connect(r),console.log("conectado a mongo")}catch(e){console.log("error conectando a mongo")}}))}disconnect(){return n(this,void 0,void 0,(function*(){i.connection.close(),console.log("desconectado de mongo")}))}getAll(){return n(this,void 0,void 0,(function*(){try{return yield this.model.find()}catch(e){console.log("error find()")}}))}newProd(e){return n(this,void 0,void 0,(function*(){try{let o=yield this.getLast();null==o&&(o=1);let t=new this.model({id:o+1,title:e.title,description:e.description,thumbnail:e.thumbnail,price:e.price,stock:e.stock});yield t.save(),console.log("se guardo correctamente")}catch(e){console.log("error al guardar")}}))}deleteById(e){return n(this,void 0,void 0,(function*(){try{yield this.model.deleteOne({id:e}),console.log("se elimino correctamente")}catch(e){console.log("error al eliminar")}}))}update(e,o){return n(this,void 0,void 0,(function*(){try{yield this.model.findOneAndUpdate({id:o},{id:o,title:e.title,description:e.description,thumbnail:e.thumbnail,price:e.price,stock:e.stock})}catch(e){console.log("error al actualizar")}}))}getById(e){return n(this,void 0,void 0,(function*(){try{return yield this.model.find({id:e})}catch(e){console.log("error find()")}}))}}},792:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.mongoURL=void 0,o.mongoURL="mongodb+srv://juanitrotti:LZKYuy4d6JQGAuyC@juanignaciomongo.25f7r.mongodb.net/ecommerce?retryWrites=true&w=majority"},58:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.cart=o.product=void 0;const n=t(185),i=new n.Schema({id:{type:Number,required:!0,unique:!0,index:!0},title:{type:String,required:!0,max:200},description:{type:String,required:!0,max:200},thumbnail:{type:String,required:!0},price:{type:Number,required:!0},stock:{type:Number,required:!0}});o.product=n.model("product",i);const r=new n.Schema({id:{type:Number,required:!0,unique:!0,index:!0},date:{type:Date,required:!0},product:{type:Array,required:!0}});o.cart=n.model("cart",r)},728:function(e,o,t){var n=this&&this.__createBinding||(Object.create?function(e,o,t,n){void 0===n&&(n=t);var i=Object.getOwnPropertyDescriptor(o,t);i&&!("get"in i?!o.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return o[t]}}),Object.defineProperty(e,n,i)}:function(e,o,t,n){void 0===n&&(n=t),e[n]=o[t]}),i=this&&this.__setModuleDefault||(Object.create?function(e,o){Object.defineProperty(e,"default",{enumerable:!0,value:o})}:function(e,o){e.default=o}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var o={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&n(o,e,t);return i(o,e),o},c=this&&this.__awaiter||function(e,o,t,n){return new(t||(t=Promise))((function(i,r){function c(e){try{l(n.next(e))}catch(e){r(e)}}function d(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var o;e.done?i(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(c,d)}l((n=n.apply(e,o||[])).next())}))};Object.defineProperty(o,"__esModule",{value:!0}),t(185);const d=t(860),{checkAuth:l}=t(129),{carritoMongoManage:a}=t(892),{productMongoManage:s}=t(599),{carritoFirebaseManage:u}=t(857),v=r(t(58)),{mongoURL:y}=t(792),g=d();g.use(d.urlencoded({extended:!0}));const{Router:f}=d,h=new f,p=new f,m=new f;h.use(d.json()),g.use("/api",h),h.use("/productos",p),h.use("/carrito",m),p.get("/:id?",((e,o)=>c(void 0,void 0,void 0,(function*(){let{id:t}=e.params,n=new s(v.product);if(yield n.connect(),void 0===t){let e=yield n.getAll();o.json(e)}else{let e=yield n.getById(t);void 0===e&&o.json("no existe el producto"),o.json(e)}yield n.disconnect()})))),p.post("/",((e,o)=>c(void 0,void 0,void 0,(function*(){if(l()){let o=new s(v.product);yield o.connect(),yield o.newProd(e.body),yield o.disconnect()}else o.json("no esta autorizado")})))),p.put("/:id",((e,o)=>c(void 0,void 0,void 0,(function*(){if(l()){let{id:t}=e.params,n=new s(v.product);yield n.connect(),void 0===(yield n.getById(t))?o.json("no existe el producto"):(yield n.update(e.body,t),o.json("actualizado")),yield n.disconnect()}else o.json("no esta autorizado")})))),p.delete("/:id",((e,o)=>c(void 0,void 0,void 0,(function*(){if(l()){let{id:t}=e.params,n=new s(v.product);yield n.connect(),yield n.deleteById(t),o.json(yield n.getAll()),yield n.disconnect()}else o.json("no esta autorizado")})))),m.post("/",((e,o)=>c(void 0,void 0,void 0,(function*(){let t=new a(v.cart);yield t.connect(),o.json(yield t.createCarrito(e.body)),yield t.disconnect()})))),m.delete("/:id",((e,o)=>c(void 0,void 0,void 0,(function*(){let t=new a(v.cart);yield t.connect(),o.json(yield t.deleteCarritoById(e.params.id)),yield t.disconnect()})))),m.get("/:id/productos",((e,o)=>c(void 0,void 0,void 0,(function*(){let t=new a(v.cart);yield t.connect(),o.json(yield t.carritoById(e.params.id)),yield t.disconnect()})))),m.post("/:id?/productos",((e,o)=>c(void 0,void 0,void 0,(function*(){let t=new a(v.cart);yield t.connect(),yield t.pushProduct(e.params.id,e.body),o.json("se agrego el producto"),yield t.disconnect()})))),m.delete("/:idCarr/productos/:idProd",((e,o)=>c(void 0,void 0,void 0,(function*(){let t=new a(v.cart);yield t.connect(),yield t.deleteProductById(e.params.idCarr,e.params.idProd),o.json("se elimino el producto"),yield t.disconnect()})))),g.listen(8080,(()=>{console.log("Server running on port 8080")})).on("error",(e=>console.log(e)))},860:e=>{e.exports=require("express")},509:e=>{e.exports=require("firebase-admin")},185:e=>{e.exports=require("mongoose")},894:e=>{e.exports=JSON.parse('{"type":"service_account","project_id":"proyectofinalbackend-f565c","private_key_id":"d0d346b6235578ee67616d6e7c4fd2a53192f474","private_key":"-----BEGIN PRIVATE KEY-----\\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDM89yI5rcm5fkf\\nmoHNUfcCGDvZrO7sb0SVJ0SZKTgDwrTtRrLq9RKdTBT8piYfJQDcdgdAARhtKI0G\\n7dIofU+cdUv/HgO7wWJ3Gvl9ExQbQ87GSxBpVlgwkfY6GR7WmUtVoMtf9j5c+d4A\\nuAD/cpToKNdc0ipXRjgfl8U6UM+KmFxZXUK0JZwkuRNJg3Kjn9jKXnaZLFVWoAmf\\noN8+3C8mHw+A6ZRubQJHF6PbEQkdUEOHUI4uChHDzT+JAf142cOji5In4vEZslKM\\nwWGZ9ZNRpBXA0RZ4SNZmjyc5E7sfYi8vauhr//APbOKO9+a+zSZ/7B6VBv7OWFAI\\nQBmpnuCVAgMBAAECggEACb1I7JnczZS+IEStCGnDDYQYoVZ4ysmFfnpYOy2x7hPR\\nmeOd2vvRv6HURCaiccvGB7P1fOglwKzdpBz8Zf+BH1PqTEb2hx9AePJ83/cJIeaO\\nAURN6ljiZfnPCUxqTRO0eG7ksJG4vZ2uHBCiaNaJbE2Mi7+nqBq7zgczUHsd8bMI\\nDZV2u3PDW9WNiuA8vcKvC6EnnrWoMIgiVfuZ1UrgiH0vLtvR1yZSRV9klePQxmC6\\nDsd+QyV0zOmL8on/6WhdzUCMwJKjxIUN3pYOuEFGrV8dJ5MK6OXdbVxiW5HaR/rK\\n4Qip1wtPVisys6nKcSEQEUQo/xMS81BBAMxy/yim4QKBgQDnocwsg+0DTNwjCKUm\\nrawCI8c8doXuXlUOIatloutCvIeANIQLb2Mdg2nkS2+DSljV6TOdxwwNIfGbIPDo\\nqhP+5SZi5UgtNmaE4mRceKRqVT3TjxgRTuVAMDWh9vn7T8onDV2Ecnl1LGhhA42f\\nfFc1+oKa+O9ogZaunG2Mis8wiQKBgQDig4vMw0O8sDjj1VA0EWZjIhgm4litGU+Y\\ntGiEI7ud9ojRaVvAJ8T5lhXDSqi6qcUq91Zr16hXkdrp9/MRg3s5CLsAbFSJtEO+\\nPchLRr78Uz9xrU8NHNSyCEcvf9fkNk+m7nDICW64XGJHttTUPXy3963+NNClXZAz\\ntNyRs3V0rQKBgQCVpS4nREQHccx2xcsMpf8OktbQ9TGpwj/pFU+KJisfvnU8GrGE\\nQb4i/xeWajXs+EdUS4kRUdszUM6qjimV5utsLdcS5VYv/4lUKH72TurJ17BN0ZCW\\n/gWV5o9/x/PQrMfJWxUj0GEvljUJGCaS9t3Q/bsLK/Bf7/jNbjpIJhWdIQKBgQDR\\n7VxpPybN/vwamx2jw+SCR5zenLPWaTjNq5WZsYw2D8ApZF22LqVtMt2kitLpfGHR\\nOj2L4OiRkAm1ASjyuEpBR4gYEk4e+UQ3UgcJTN2/+F86OYaj/m5ZOTbQHMm3JWaY\\nrS81FRjaIDSthhKlSP8HeLJ2f/hG6fm1Eg/BsPJQWQKBgEta8WTH4TZXGHS+yCE5\\nDrBl0slGw7c+MRnrxsVIWlEw+iJy+C0JV10eNlBTK21aU+2gwNjODvkJIHdqToTp\\n03nvciMAf1t3VHjGdLZ/kfIqq8B7X943G3eW/jws9sGPXKNvc8cgsdvjlohVeHTG\\nTdvXZD2mMbv7EkX1L+BaW+m/\\n-----END PRIVATE KEY-----\\n","client_email":"firebase-adminsdk-ws82t@proyectofinalbackend-f565c.iam.gserviceaccount.com","client_id":"110615722786650505051","auth_uri":"https://accounts.google.com/o/oauth2/auth","token_uri":"https://oauth2.googleapis.com/token","auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs","client_x509_cert_url":"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-ws82t%40proyectofinalbackend-f565c.iam.gserviceaccount.com"}')}},o={};!function t(n){var i=o[n];if(void 0!==i)return i.exports;var r=o[n]={exports:{}};return e[n].call(r.exports,r,r.exports,t),r.exports}(728)})();